!function(e){function t(t){for(var s,o,c=t[0],a=t[1],u=t[2],d=0,h=[];d<c.length;d++)o=c[d],r[o]&&h.push(r[o][0]),r[o]=0;for(s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s]);for(l&&l(t);h.length;)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],s=!0,c=1;c<n.length;c++){var a=n[c];0!==r[a]&&(s=!1)}s&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var s={},r={main:0},i=[];function o(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=s,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(n,s,function(t){return e[t]}.bind(null,s));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var c=window.webpackJsonp=window.webpackJsonp||[],a=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=a;i.push([0,"vendor"]),n()}({"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/index.js!./node_modules/postcss-loader/src/index.js?!./node_modules/sass-loader/lib/loader.js!./resources/scss/field.scss":
/*!********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/postcss-loader/src??embedded!./node_modules/sass-loader/lib/loader.js!./resources/scss/field.scss ***!
  \********************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,n){},"./resources/js/RelatedEntryTypesField.ts":
/*!************************************************!*\
  !*** ./resources/js/RelatedEntryTypesField.ts ***!
  \************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=n(/*! ./components/ChannelGroup */"./resources/js/components/ChannelGroup.ts"),r=n(/*! ./components/SectionMap */"./resources/js/components/SectionMap.ts"),i=n(/*! ./components/EntryTypeGroup */"./resources/js/components/EntryTypeGroup.ts"),o=function(){function e(e){var t=this;console.log(e),this.activeSections=[],this.fieldContainer=document.querySelector("#unionco-relatedentrytypes-fields-RelatedEntryTypesField");var n=this.fieldContainer.querySelector("[data-related-entry-types-channels]");if(n){this.channelGroup=new s.default(n),this.activeSections=this.channelGroup.getActiveChannels();var o=JSON.parse(n.dataset.relatedEntryTypesChannels);console.log(o),this.sectionMap=new r.default(o.sections,o.entryTypes)}var c=this.fieldContainer.querySelector("[data-related-entry-types-select-area]");c&&(this.entryTypeGroup=new i.default(c),this.entryTypeGroup.setEntryTypes(this.sectionMap.getEntryTypesByChannelArray(this.activeSections)),this.entryTypeGroup.render()),this.updateActiveSections=this.updateActiveSections.bind(this),this.fieldContainer.addEventListener("channelChange",function(e){var n=e.detail,s=n.all,r=n.active;console.log(n),t.updateActiveSections(s,r)})}return e.prototype.updateActiveSections=function(e,t){this.activeSections=e?t?this.channelGroup.getChannels():[]:this.channelGroup.getActiveChannels();var n=this.sectionMap.getEntryTypesByChannelArray(this.activeSections);this.entryTypeGroup.setEntryTypes(n),this.entryTypeGroup.render()},e}();t.default=o,window.RelatedEntryTypesField=o},"./resources/js/components/AllChannel.ts":
/*!***********************************************!*\
  !*** ./resources/js/components/AllChannel.ts ***!
  \***********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s,r=n(/*! ./Channel */"./resources/js/components/Channel.ts"),i=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.checkboxChangeHandler=function(e){var t=e.target;this.active=t.checked;var n=new CustomEvent("channelChange",{detail:{sectionUid:this.uid,active:this.active,all:!0},bubbles:!0});return this.checkbox.dispatchEvent(n)},t}(r.default);t.default=o},"./resources/js/components/Channel.ts":
/*!********************************************!*\
  !*** ./resources/js/components/Channel.ts ***!
  \********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=function(){function e(e){this.checkbox=e,this.active=e.checked;var t=e.value.match(/section:(.*)/);t&&t.length&&(this.uid=t[1]),this.name=e.value;var n=document.querySelector('label[for="'+this.checkbox.id+'"]');n&&(this.label=n.innerText),this.checkboxChangeHandler=this.checkboxChangeHandler.bind(this),this.updateActiveStatus=this.updateActiveStatus.bind(this),this.checkbox.addEventListener("change",this.checkboxChangeHandler)}return e.prototype.updateActiveStatus=function(){this.active=this.checkbox.checked},e.prototype.checkboxChangeHandler=function(e){var t=e.target;this.active=t.checked;var n=new CustomEvent("channelChange",{detail:{sectionUid:this.uid,active:this.active,all:!1},bubbles:!0});return this.checkbox.dispatchEvent(n)},e}();t.default=s},"./resources/js/components/ChannelGroup.ts":
/*!*************************************************!*\
  !*** ./resources/js/components/ChannelGroup.ts ***!
  \*************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=n(/*! ./Channel */"./resources/js/components/Channel.ts"),r=n(/*! ./AllChannel */"./resources/js/components/AllChannel.ts"),i=function(){function e(e){this.node=e;var t=e.querySelectorAll('input[type="checkbox"]');this.channels=Array.from(t).map(function(e){return"*"===e.value?new r.default(e):new s.default(e)}),this.getActiveChannels=this.getActiveChannels.bind(this),this.getChannels=this.getChannels.bind(this)}return e.prototype.getChannels=function(){return this.channels},e.prototype.getActiveChannels=function(){var e=this.channels.filter(function(e){return e.updateActiveStatus(),e.active});return console.log("getActiveChannels",e),e},e}();t.default=i},"./resources/js/components/EntryType.ts":
/*!**********************************************!*\
  !*** ./resources/js/components/EntryType.ts ***!
  \**********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=function(){function e(e){this.id=e.id,this.label=e.label,this.sectionUid=e.sectionUid,this.active=e.active,this.toHtml=this.toHtml.bind(this)}return e.prototype.toHtml=function(){return'<div>\n            <input type="checkbox" name="types[unionco\\relatedentrytypes\\fields\\RelatedEntryTypesField][entryTypes][]" class="checkbox" value="'+this.id+'" id="entryType-'+this.id+'" '+(this.active?"checked":"")+'/>\n            <label for="entryType-'+this.id+'">'+this.label+"</label>\n        </div>"},e}();t.default=s},"./resources/js/components/EntryTypeGroup.ts":
/*!***************************************************!*\
  !*** ./resources/js/components/EntryTypeGroup.ts ***!
  \***************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=function(){function e(e){this.node=e}return e.prototype.render=function(){var e="";this.entryTypes.length&&(e=this.entryTypes.map(function(e){return e.toHtml()}).reduce(function(e,t){return e+t})),this.node.innerHTML='\n        <div class="field">\n            <div class="heading">\n                <label>EntryTypes</label>\n            </div>\n            <div class="input ltr">\n                <div class="checkbox-select">\n                    '+e+"\n                </div>\n            </div>\n        </div>"},e.prototype.setEntryTypes=function(e){this.entryTypes=e},e}();t.default=s},"./resources/js/components/SectionMap.ts":
/*!***********************************************!*\
  !*** ./resources/js/components/SectionMap.ts ***!
  \***********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=n(/*! ./EntryType */"./resources/js/components/EntryType.ts"),r=function(){function e(e,t){this.sections=e,this.entryTypes=t.map(function(e){return new s.default(e)}),this.getEntryTypesBySectionUid=this.getEntryTypesBySectionUid.bind(this),this.getEntryTypesBySectionUidArray=this.getEntryTypesBySectionUidArray.bind(this),this.getEntryTypesByChannelArray=this.getEntryTypesByChannelArray.bind(this)}return e.prototype.getEntryTypesBySectionUid=function(e){if(!e||!e.length)return[];var t=this.entryTypes.filter(function(t){return t.sectionUid===e});return t&&t.length?t:[]},e.prototype.getEntryTypesBySectionUidArray=function(e){var t=this,n=[];return e.forEach(function(e){t.getEntryTypesBySectionUid(e).forEach(function(e){n.push(e)})}),n},e.prototype.getEntryTypesByChannelArray=function(e){var t=e.map(function(e){return e.uid});return this.getEntryTypesBySectionUidArray(t)},e}();t.default=r},"./resources/scss/field.scss":
/*!***********************************!*\
  !*** ./resources/scss/field.scss ***!
  \***********************************/
/*! no static exports found */function(e,t,n){var s=n(/*! !../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader!../../node_modules/postcss-loader/src??embedded!../../node_modules/sass-loader/lib/loader.js!./field.scss */"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/index.js!./node_modules/postcss-loader/src/index.js?!./node_modules/sass-loader/lib/loader.js!./resources/scss/field.scss");"string"==typeof s&&(s=[[e.i,s,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(/*! ../../node_modules/style-loader/lib/addStyles.js */"./node_modules/style-loader/lib/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},0:
/*!**********************************************************************************!*\
  !*** multi ./resources/js/RelatedEntryTypesField.ts ./resources/scss/field.scss ***!
  \**********************************************************************************/
/*! no static exports found */function(e,t,n){n(/*! /Users/abryrath/Union/Library/relatedentrytypes/resources/js/RelatedEntryTypesField.ts */"./resources/js/RelatedEntryTypesField.ts"),e.exports=n(/*! /Users/abryrath/Union/Library/relatedentrytypes/resources/scss/field.scss */"./resources/scss/field.scss")}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vcmVzb3VyY2VzL2pzL1JlbGF0ZWRFbnRyeVR5cGVzRmllbGQudHMiLCJ3ZWJwYWNrOi8vLy4vcmVzb3VyY2VzL2pzL2NvbXBvbmVudHMvQWxsQ2hhbm5lbC50cyIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvY29tcG9uZW50cy9DaGFubmVsLnRzIiwid2VicGFjazovLy8uL3Jlc291cmNlcy9qcy9jb21wb25lbnRzL0NoYW5uZWxHcm91cC50cyIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvY29tcG9uZW50cy9FbnRyeVR5cGUudHMiLCJ3ZWJwYWNrOi8vLy4vcmVzb3VyY2VzL2pzL2NvbXBvbmVudHMvRW50cnlUeXBlR3JvdXAudHMiLCJ3ZWJwYWNrOi8vLy4vcmVzb3VyY2VzL2pzL2NvbXBvbmVudHMvU2VjdGlvbk1hcC50cyIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvc2Nzcy9maWVsZC5zY3NzIl0sIm5hbWVzIjpbIndlYnBhY2tKc29ucENhbGxiYWNrIiwiZGF0YSIsIm1vZHVsZUlkIiwiY2h1bmtJZCIsImNodW5rSWRzIiwibW9yZU1vZHVsZXMiLCJleGVjdXRlTW9kdWxlcyIsImkiLCJyZXNvbHZlcyIsImxlbmd0aCIsImluc3RhbGxlZENodW5rcyIsInB1c2giLCJPYmplY3QiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJtb2R1bGVzIiwicGFyZW50SnNvbnBGdW5jdGlvbiIsInNoaWZ0IiwiZGVmZXJyZWRNb2R1bGVzIiwiYXBwbHkiLCJjaGVja0RlZmVycmVkTW9kdWxlcyIsInJlc3VsdCIsImRlZmVycmVkTW9kdWxlIiwiZnVsZmlsbGVkIiwiaiIsImRlcElkIiwic3BsaWNlIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsInMiLCJpbnN0YWxsZWRNb2R1bGVzIiwibWFpbiIsImV4cG9ydHMiLCJtb2R1bGUiLCJsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInAiLCJqc29ucEFycmF5Iiwid2luZG93Iiwib2xkSnNvbnBGdW5jdGlvbiIsInNsaWNlIiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsIl9jb21wb25lbnRzX0NoYW5uZWxHcm91cF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fIiwiX2NvbXBvbmVudHNfU2VjdGlvbk1hcF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fIiwiX2NvbXBvbmVudHNfRW50cnlUeXBlR3JvdXBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfXyIsIlJlbGF0ZWRFbnRyeVR5cGVzRmllbGQiLCJqc29uVmFycyIsIl90aGlzIiwidGhpcyIsImNvbnNvbGUiLCJsb2ciLCJhY3RpdmVTZWN0aW9ucyIsImZpZWxkQ29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2hhbm5lbEdyb3VwQ29udGFpbmVyIiwiY2hhbm5lbEdyb3VwIiwiZ2V0QWN0aXZlQ2hhbm5lbHMiLCJzZWN0aW9uTWFwRGF0YSIsIkpTT04iLCJwYXJzZSIsImRhdGFzZXQiLCJyZWxhdGVkRW50cnlUeXBlc0NoYW5uZWxzIiwic2VjdGlvbk1hcCIsInNlY3Rpb25zIiwiZW50cnlUeXBlcyIsImVudHJ5VHlwZXNHcm91cENvbnRhaW5lciIsImVudHJ5VHlwZUdyb3VwIiwic2V0RW50cnlUeXBlcyIsImdldEVudHJ5VHlwZXNCeUNoYW5uZWxBcnJheSIsInJlbmRlciIsInVwZGF0ZUFjdGl2ZVNlY3Rpb25zIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJldmVudERldGFpbCIsImRldGFpbCIsImFsbCIsImFjdGl2ZSIsImdldENoYW5uZWxzIiwiQWxsQ2hhbm5lbCIsIl9zdXBlciIsIm5vZGUiLCJfX2V4dGVuZHMiLCJjaGVja2JveENoYW5nZUhhbmRsZXIiLCJjaGFuZ2VFdmVudCIsInRhcmdldCIsImNoZWNrZWQiLCJldmVudCIsIkN1c3RvbUV2ZW50Iiwic2VjdGlvblVpZCIsInVpZCIsImJ1YmJsZXMiLCJjaGVja2JveCIsImRpc3BhdGNoRXZlbnQiLCJfQ2hhbm5lbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fIiwiQ2hhbm5lbCIsInVpZE1hdGNoIiwibWF0Y2giLCJsYWJlbCIsImlkIiwiaW5uZXJUZXh0IiwidXBkYXRlQWN0aXZlU3RhdHVzIiwiX0FsbENoYW5uZWxfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfXyIsIkNoYW5uZWxHcm91cCIsImNoZWNrYm94ZXMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY2hhbm5lbHMiLCJBcnJheSIsImZyb20iLCJtYXAiLCJhY3RpdmVDaGFubmVscyIsImZpbHRlciIsImNoYW5uZWwiLCJFbnRyeVR5cGUiLCJlbnRyeVR5cGUiLCJ0b0h0bWwiLCJFbnRyeVR5cGVHcm91cCIsInJlZHVjZSIsInByZXYiLCJjdXJyZW50IiwiaW5uZXJIVE1MIiwiX0VudHJ5VHlwZV9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fIiwiU2VjdGlvbk1hcCIsImVudHJ5VHlwZU9iamVjdCIsImdldEVudHJ5VHlwZXNCeVNlY3Rpb25VaWQiLCJnZXRFbnRyeVR5cGVzQnlTZWN0aW9uVWlkQXJyYXkiLCJtYXRjaGluZ1VpZCIsInVpZHMiLCJmb3JFYWNoIiwiY29udGVudCIsIm9wdGlvbnMiLCJobXIiLCJ0cmFuc2Zvcm0iLCJpbnNlcnRJbnRvIiwidW5kZWZpbmVkIiwibG9jYWxzIl0sIm1hcHBpbmdzIjoiYUFDQSxTQUFBQSxFQUFBQyxHQVFBLElBUEEsSUFNQUMsRUFBQUMsRUFOQUMsRUFBQUgsRUFBQSxHQUNBSSxFQUFBSixFQUFBLEdBQ0FLLEVBQUFMLEVBQUEsR0FJQU0sRUFBQSxFQUFBQyxFQUFB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LENBQTJEMkgsRUFBQUMsR0FFeEVELEVBQUFNLFNBQUE1SCxFQUFBRCxRQUFBdUgsRUFBQU0iLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xuIFx0ZnVuY3Rpb24gd2VicGFja0pzb25wQ2FsbGJhY2soZGF0YSkge1xuIFx0XHR2YXIgY2h1bmtJZHMgPSBkYXRhWzBdO1xuIFx0XHR2YXIgbW9yZU1vZHVsZXMgPSBkYXRhWzFdO1xuIFx0XHR2YXIgZXhlY3V0ZU1vZHVsZXMgPSBkYXRhWzJdO1xuXG4gXHRcdC8vIGFkZCBcIm1vcmVNb2R1bGVzXCIgdG8gdGhlIG1vZHVsZXMgb2JqZWN0LFxuIFx0XHQvLyB0aGVuIGZsYWcgYWxsIFwiY2h1bmtJZHNcIiBhcyBsb2FkZWQgYW5kIGZpcmUgY2FsbGJhY2tcbiBcdFx0dmFyIG1vZHVsZUlkLCBjaHVua0lkLCBpID0gMCwgcmVzb2x2ZXMgPSBbXTtcbiBcdFx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG4gXHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG4gXHRcdFx0XHRyZXNvbHZlcy5wdXNoKGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSk7XG4gXHRcdFx0fVxuIFx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG4gXHRcdH1cbiBcdFx0Zm9yKG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG4gXHRcdFx0aWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcbiBcdFx0XHRcdG1vZHVsZXNbbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuIFx0XHRcdH1cbiBcdFx0fVxuIFx0XHRpZihwYXJlbnRKc29ucEZ1bmN0aW9uKSBwYXJlbnRKc29ucEZ1bmN0aW9uKGRhdGEpO1xuXG4gXHRcdHdoaWxlKHJlc29sdmVzLmxlbmd0aCkge1xuIFx0XHRcdHJlc29sdmVzLnNoaWZ0KCkoKTtcbiBcdFx0fVxuXG4gXHRcdC8vIGFkZCBlbnRyeSBtb2R1bGVzIGZyb20gbG9hZGVkIGNodW5rIHRvIGRlZmVycmVkIGxpc3RcbiBcdFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2guYXBwbHkoZGVmZXJyZWRNb2R1bGVzLCBleGVjdXRlTW9kdWxlcyB8fCBbXSk7XG5cbiBcdFx0Ly8gcnVuIGRlZmVycmVkIG1vZHVsZXMgd2hlbiBhbGwgY2h1bmtzIHJlYWR5XG4gXHRcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIFx0fTtcbiBcdGZ1bmN0aW9uIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCkge1xuIFx0XHR2YXIgcmVzdWx0O1xuIFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgZGVmZXJyZWRNb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG4gXHRcdFx0dmFyIGRlZmVycmVkTW9kdWxlID0gZGVmZXJyZWRNb2R1bGVzW2ldO1xuIFx0XHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuIFx0XHRcdGZvcih2YXIgaiA9IDE7IGogPCBkZWZlcnJlZE1vZHVsZS5sZW5ndGg7IGorKykge1xuIFx0XHRcdFx0dmFyIGRlcElkID0gZGVmZXJyZWRNb2R1bGVbal07XG4gXHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua3NbZGVwSWRdICE9PSAwKSBmdWxmaWxsZWQgPSBmYWxzZTtcbiBcdFx0XHR9XG4gXHRcdFx0aWYoZnVsZmlsbGVkKSB7XG4gXHRcdFx0XHRkZWZlcnJlZE1vZHVsZXMuc3BsaWNlKGktLSwgMSk7XG4gXHRcdFx0XHRyZXN1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IGRlZmVycmVkTW9kdWxlWzBdKTtcbiBcdFx0XHR9XG4gXHRcdH1cbiBcdFx0cmV0dXJuIHJlc3VsdDtcbiBcdH1cblxuIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3NcbiBcdC8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuIFx0Ly8gUHJvbWlzZSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbiBcdHZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG4gXHRcdFwibWFpblwiOiAwXG4gXHR9O1xuXG4gXHR2YXIgZGVmZXJyZWRNb2R1bGVzID0gW107XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdHZhciBqc29ucEFycmF5ID0gd2luZG93W1wid2VicGFja0pzb25wXCJdID0gd2luZG93W1wid2VicGFja0pzb25wXCJdIHx8IFtdO1xuIFx0dmFyIG9sZEpzb25wRnVuY3Rpb24gPSBqc29ucEFycmF5LnB1c2guYmluZChqc29ucEFycmF5KTtcbiBcdGpzb25wQXJyYXkucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrO1xuIFx0anNvbnBBcnJheSA9IGpzb25wQXJyYXkuc2xpY2UoKTtcbiBcdGZvcih2YXIgaSA9IDA7IGkgPCBqc29ucEFycmF5Lmxlbmd0aDsgaSsrKSB3ZWJwYWNrSnNvbnBDYWxsYmFjayhqc29ucEFycmF5W2ldKTtcbiBcdHZhciBwYXJlbnRKc29ucEZ1bmN0aW9uID0gb2xkSnNvbnBGdW5jdGlvbjtcblxuXG4gXHQvLyBhZGQgZW50cnkgbW9kdWxlIHRvIGRlZmVycmVkIGxpc3RcbiBcdGRlZmVycmVkTW9kdWxlcy5wdXNoKFswLFwidmVuZG9yXCJdKTtcbiBcdC8vIHJ1biBkZWZlcnJlZCBtb2R1bGVzIHdoZW4gcmVhZHlcbiBcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIiwiaW1wb3J0IElDaGFubmVsR3JvdXAgZnJvbSAnLi9pbnRlcmZhY2VzL0lDaGFubmVsR3JvdXAnO1xuaW1wb3J0IENoYW5uZWxHcm91cCBmcm9tICcuL2NvbXBvbmVudHMvQ2hhbm5lbEdyb3VwJztcbmltcG9ydCBJU2VjdGlvbk1hcCBmcm9tICcuL2ludGVyZmFjZXMvSVNlY3Rpb25NYXAnO1xuaW1wb3J0IElDaGFubmVsIGZyb20gJy4vaW50ZXJmYWNlcy9JQ2hhbm5lbCc7XG5pbXBvcnQgU2VjdGlvbk1hcCBmcm9tICcuL2NvbXBvbmVudHMvU2VjdGlvbk1hcCc7XG5pbXBvcnQgRW50cnlUeXBlR3JvdXAgZnJvbSAnLi9jb21wb25lbnRzL0VudHJ5VHlwZUdyb3VwJztcbmltcG9ydCBJRW50cnlUeXBlR3JvdXAgZnJvbSAnLi9pbnRlcmZhY2VzL0lFbnRyeVR5cGVHcm91cCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlbGF0ZWRFbnRyeVR5cGVzRmllbGQge1xuICAgIHB1YmxpYyBjaGFubmVsR3JvdXA6IElDaGFubmVsR3JvdXA7XG4gICAgcHVibGljIGZpZWxkQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwdWJsaWMgZW50cnlUeXBlR3JvdXA6IElFbnRyeVR5cGVHcm91cDtcbiAgICBwcml2YXRlIHNlY3Rpb25NYXA6IElTZWN0aW9uTWFwO1xuICAgIHB1YmxpYyBhY3RpdmVTZWN0aW9uczogSUNoYW5uZWxbXTtcblxuICAgIGNvbnN0cnVjdG9yKGpzb25WYXJzOiBhbnkpIHtcbiAgICAgICAgY29uc29sZS5sb2coanNvblZhcnMpO1xuICAgICAgICB0aGlzLmFjdGl2ZVNlY3Rpb25zID0gW107XG4gICAgICAgIHRoaXMuZmllbGRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdW5pb25jby1yZWxhdGVkZW50cnl0eXBlcy1maWVsZHMtUmVsYXRlZEVudHJ5VHlwZXNGaWVsZCcpO1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGNoYW5uZWxzIHNlbGVjdCBhcmVhXG4gICAgICAgIGNvbnN0IGNoYW5uZWxHcm91cENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQgPSB0aGlzLmZpZWxkQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXJlbGF0ZWQtZW50cnktdHlwZXMtY2hhbm5lbHNdJyk7XG4gICAgICAgIGlmIChjaGFubmVsR3JvdXBDb250YWluZXIpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbm5lbEdyb3VwID0gbmV3IENoYW5uZWxHcm91cChjaGFubmVsR3JvdXBDb250YWluZXIpO1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVTZWN0aW9ucyA9IHRoaXMuY2hhbm5lbEdyb3VwLmdldEFjdGl2ZUNoYW5uZWxzKCk7XG4gICAgICAgICAgICBjb25zdCBzZWN0aW9uTWFwRGF0YTogSVNlY3Rpb25NYXAgPSBKU09OLnBhcnNlKGNoYW5uZWxHcm91cENvbnRhaW5lci5kYXRhc2V0LnJlbGF0ZWRFbnRyeVR5cGVzQ2hhbm5lbHMpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc2VjdGlvbk1hcERhdGEpO1xuICAgICAgICAgICAgdGhpcy5zZWN0aW9uTWFwID0gbmV3IFNlY3Rpb25NYXAoc2VjdGlvbk1hcERhdGEuc2VjdGlvbnMsIHNlY3Rpb25NYXBEYXRhLmVudHJ5VHlwZXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZW50cnlUeXBlc0dyb3VwQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCA9IHRoaXMuZmllbGRDb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtcmVsYXRlZC1lbnRyeS10eXBlcy1zZWxlY3QtYXJlYV0nKTtcblxuICAgICAgICBpZiAoZW50cnlUeXBlc0dyb3VwQ29udGFpbmVyKSB7XG4gICAgICAgICAgICB0aGlzLmVudHJ5VHlwZUdyb3VwID0gbmV3IEVudHJ5VHlwZUdyb3VwKGVudHJ5VHlwZXNHcm91cENvbnRhaW5lcik7XG5cbiAgICAgICAgICAgIHRoaXMuZW50cnlUeXBlR3JvdXAuc2V0RW50cnlUeXBlcyh0aGlzLnNlY3Rpb25NYXAuZ2V0RW50cnlUeXBlc0J5Q2hhbm5lbEFycmF5KHRoaXMuYWN0aXZlU2VjdGlvbnMpKTtcbiAgICAgICAgICAgIHRoaXMuZW50cnlUeXBlR3JvdXAucmVuZGVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNZXRob2QgYmluZGluZ1xuICAgICAgICB0aGlzLnVwZGF0ZUFjdGl2ZVNlY3Rpb25zID0gdGhpcy51cGRhdGVBY3RpdmVTZWN0aW9ucy5iaW5kKHRoaXMpO1xuXG4gICAgICAgIC8vIEV2ZW50IExpc3RlbmVyc1xuICAgICAgICB0aGlzLmZpZWxkQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5uZWxDaGFuZ2UnLCAoZTogQ3VzdG9tRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50RGV0YWlsID0gZS5kZXRhaWw7XG4gICAgICAgICAgICBjb25zdCB7IGFsbCwgYWN0aXZlIH0gPSBldmVudERldGFpbDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGV2ZW50RGV0YWlsKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQWN0aXZlU2VjdGlvbnMoYWxsLCBhY3RpdmUpOyAvLyBzZWN0aW9uVWlkLCBhY3RpdmUpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdXBkYXRlQWN0aXZlU2VjdGlvbnMoYWxsOiBib29sZWFuLCBhY3RpdmU6IGJvb2xlYW4pIHtcbiAgICAgICAgaWYgKGFsbCkge1xuICAgICAgICAgICAgaWYgKGFjdGl2ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlU2VjdGlvbnMgPSB0aGlzLmNoYW5uZWxHcm91cC5nZXRDaGFubmVscygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZVNlY3Rpb25zID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZVNlY3Rpb25zID0gdGhpcy5jaGFubmVsR3JvdXAuZ2V0QWN0aXZlQ2hhbm5lbHMoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlbnRyeVR5cGVzID0gdGhpcy5zZWN0aW9uTWFwLmdldEVudHJ5VHlwZXNCeUNoYW5uZWxBcnJheSh0aGlzLmFjdGl2ZVNlY3Rpb25zKTtcblxuICAgICAgICB0aGlzLmVudHJ5VHlwZUdyb3VwLnNldEVudHJ5VHlwZXMoZW50cnlUeXBlcyk7XG4gICAgICAgIHRoaXMuZW50cnlUeXBlR3JvdXAucmVuZGVyKCk7XG4gICAgfVxufVxuXG5kZWNsYXJlIGdsb2JhbCB7XG4gICAgaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgICAgIFJlbGF0ZWRFbnRyeVR5cGVzRmllbGQ6IGFueTtcbiAgICB9XG59XG5cbndpbmRvdy5SZWxhdGVkRW50cnlUeXBlc0ZpZWxkID0gUmVsYXRlZEVudHJ5VHlwZXNGaWVsZDsiLCJpbXBvcnQgSUNoYW5uZWwgZnJvbSBcIi4uL2ludGVyZmFjZXMvSUNoYW5uZWxcIjtcbmltcG9ydCBDaGFubmVsIGZyb20gJy4vQ2hhbm5lbCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFsbENoYW5uZWwgZXh0ZW5kcyBDaGFubmVsIGltcGxlbWVudHMgSUNoYW5uZWwge1xuICAgIGNvbnN0cnVjdG9yKG5vZGU6IEhUTUxJbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgc3VwZXIobm9kZSk7XG4gICAgfVxuXG4gICAgcHVibGljIGNoZWNrYm94Q2hhbmdlSGFuZGxlcihjaGFuZ2VFdmVudDogRXZlbnQpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0OiBIVE1MSW5wdXRFbGVtZW50ID0gY2hhbmdlRXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIHRoaXMuYWN0aXZlID0gdGFyZ2V0LmNoZWNrZWQ7XG5cbiAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2NoYW5uZWxDaGFuZ2UnLCB7XG4gICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgICBzZWN0aW9uVWlkOiB0aGlzLnVpZCxcbiAgICAgICAgICAgICAgICBhY3RpdmU6IHRoaXMuYWN0aXZlLFxuICAgICAgICAgICAgICAgIGFsbDogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJ1YmJsZXM6IHRydWVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tib3guZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgfVxufSIsImltcG9ydCBJQ2hhbm5lbCBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JQ2hhbm5lbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaGFubmVsIGltcGxlbWVudHMgSUNoYW5uZWwge1xuICAgIHByb3RlY3RlZCBjaGVja2JveDogSFRNTElucHV0RWxlbWVudDtcbiAgICBwdWJsaWMgbmFtZTogc3RyaW5nO1xuICAgIHB1YmxpYyBsYWJlbDogc3RyaW5nO1xuICAgIHB1YmxpYyB1aWQ6IHN0cmluZztcbiAgICBwdWJsaWMgYWN0aXZlOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3Iobm9kZTogSFRNTElucHV0RWxlbWVudCkge1xuICAgICAgICB0aGlzLmNoZWNrYm94ID0gbm9kZTtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSBub2RlLmNoZWNrZWQ7XG5cbiAgICAgICAgY29uc3QgdWlkTWF0Y2ggPSBub2RlLnZhbHVlLm1hdGNoKC9zZWN0aW9uOiguKikvKTtcbiAgICAgICAgXG4gICAgICAgIGlmICh1aWRNYXRjaCAmJiB1aWRNYXRjaC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMudWlkID0gdWlkTWF0Y2hbMV07XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm5hbWUgPSBub2RlLnZhbHVlO1xuICAgICAgICBjb25zdCBsYWJlbDogSFRNTExhYmVsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGxhYmVsW2Zvcj1cIiR7dGhpcy5jaGVja2JveC5pZH1cIl1gKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICAgICAgdGhpcy5sYWJlbCA9IGxhYmVsLmlubmVyVGV4dDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1ldGhvZCBiaW5kaW5nXG4gICAgICAgIHRoaXMuY2hlY2tib3hDaGFuZ2VIYW5kbGVyID0gdGhpcy5jaGVja2JveENoYW5nZUhhbmRsZXIuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy51cGRhdGVBY3RpdmVTdGF0dXMgPSB0aGlzLnVwZGF0ZUFjdGl2ZVN0YXR1cy5iaW5kKHRoaXMpO1xuXG4gICAgICAgIHRoaXMuY2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5jaGVja2JveENoYW5nZUhhbmRsZXIpO1xuICAgIH1cblxuICAgIHB1YmxpYyB1cGRhdGVBY3RpdmVTdGF0dXMoKSB7XG4gICAgICAgIHRoaXMuYWN0aXZlID0gdGhpcy5jaGVja2JveC5jaGVja2VkO1xuICAgIH1cblxuICAgIHB1YmxpYyBjaGVja2JveENoYW5nZUhhbmRsZXIoY2hhbmdlRXZlbnQ6IEV2ZW50KTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHRhcmdldDogSFRNTElucHV0RWxlbWVudCA9IGNoYW5nZUV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICB0aGlzLmFjdGl2ZSA9IHRhcmdldC5jaGVja2VkO1xuXG4gICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdjaGFubmVsQ2hhbmdlJywge1xuICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgc2VjdGlvblVpZDogdGhpcy51aWQsXG4gICAgICAgICAgICAgICAgYWN0aXZlOiB0aGlzLmFjdGl2ZSxcbiAgICAgICAgICAgICAgICBhbGw6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYnViYmxlczogdHJ1ZVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gdGhpcy5jaGVja2JveC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICB9XG59IiwiaW1wb3J0IElDaGFubmVsR3JvdXAgZnJvbSAnLi4vaW50ZXJmYWNlcy9JQ2hhbm5lbEdyb3VwJztcbmltcG9ydCBJQ2hhbm5lbCBmcm9tICcuLi9pbnRlcmZhY2VzL0lDaGFubmVsJztcbmltcG9ydCBDaGFubmVsIGZyb20gJy4vQ2hhbm5lbCc7XG5pbXBvcnQgQWxsQ2hhbm5lbCBmcm9tICcuL0FsbENoYW5uZWwnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaGFubmVsR3JvdXAgaW1wbGVtZW50cyBJQ2hhbm5lbEdyb3VwIHtcbiAgICBwcml2YXRlIGNoYW5uZWxzOiBJQ2hhbm5lbFtdO1xuICAgIHByaXZhdGUgbm9kZTogSFRNTERpdkVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3Rvcihub2RlOiBIVE1MRGl2RWxlbWVudCkge1xuICAgICAgICB0aGlzLm5vZGUgPSBub2RlO1xuICAgICAgICBjb25zdCBjaGVja2JveGVzOiBOb2RlTGlzdE9mPEhUTUxJbnB1dEVsZW1lbnQ+ID0gbm9kZS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKTtcbiAgICAgICAgdGhpcy5jaGFubmVscyA9IEFycmF5LmZyb20oY2hlY2tib3hlcylcbiAgICAgICAgICAgIC5tYXAoKGNoZWNrYm94OiBIVE1MSW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGNoZWNrYm94LnZhbHVlID09PSAnKicpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGxDaGFubmVsKGNoZWNrYm94KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENoYW5uZWwoY2hlY2tib3gpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAvLyBNZXRob2QgYmluZGluZ1xuICAgICAgICB0aGlzLmdldEFjdGl2ZUNoYW5uZWxzID0gdGhpcy5nZXRBY3RpdmVDaGFubmVscy5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLmdldENoYW5uZWxzID0gdGhpcy5nZXRDaGFubmVscy5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRDaGFubmVscygpOiBJQ2hhbm5lbFtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbm5lbHM7XG4gICAgfVxuXG4gICAgcHVibGljIGdldEFjdGl2ZUNoYW5uZWxzKCk6IElDaGFubmVsW10ge1xuICAgICAgICBjb25zdCBhY3RpdmVDaGFubmVscyA9IHRoaXMuY2hhbm5lbHMuZmlsdGVyKChjaGFubmVsOiBJQ2hhbm5lbCkgPT4ge1xuICAgICAgICAgICAgY2hhbm5lbC51cGRhdGVBY3RpdmVTdGF0dXMoKTtcbiAgICAgICAgICAgIHJldHVybiBjaGFubmVsLmFjdGl2ZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ2dldEFjdGl2ZUNoYW5uZWxzJywgYWN0aXZlQ2hhbm5lbHMpO1xuICAgICAgICByZXR1cm4gYWN0aXZlQ2hhbm5lbHM7XG4gICAgfVxufSIsImltcG9ydCBJRW50cnlUeXBlIGZyb20gJy4uL2ludGVyZmFjZXMvSUVudHJ5VHlwZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVudHJ5VHlwZSBpbXBsZW1lbnRzIElFbnRyeVR5cGUge1xuICAgIHB1YmxpYyBpZDogbnVtYmVyO1xuICAgIHB1YmxpYyBsYWJlbDogc3RyaW5nO1xuICAgIHB1YmxpYyBzZWN0aW9uVWlkOiBzdHJpbmc7XG4gICAgcHVibGljIGFjdGl2ZTogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKGVudHJ5VHlwZTogSUVudHJ5VHlwZSkge1xuICAgICAgICB0aGlzLmlkID0gZW50cnlUeXBlLmlkO1xuICAgICAgICB0aGlzLmxhYmVsID0gZW50cnlUeXBlLmxhYmVsO1xuICAgICAgICB0aGlzLnNlY3Rpb25VaWQgPSBlbnRyeVR5cGUuc2VjdGlvblVpZDtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSBlbnRyeVR5cGUuYWN0aXZlO1xuXG4gICAgICAgIHRoaXMudG9IdG1sID0gdGhpcy50b0h0bWwuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdG9IdG1sKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgPGRpdj5cbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuYW1lPVwidHlwZXNbdW5pb25jb1xcXFxyZWxhdGVkZW50cnl0eXBlc1xcXFxmaWVsZHNcXFxcUmVsYXRlZEVudHJ5VHlwZXNGaWVsZF1bZW50cnlUeXBlc11bXVwiIGNsYXNzPVwiY2hlY2tib3hcIiB2YWx1ZT1cIiR7dGhpcy5pZH1cIiBpZD1cImVudHJ5VHlwZS0ke3RoaXMuaWR9XCIgJHt0aGlzLmFjdGl2ZSA/ICdjaGVja2VkJyA6ICcnIH0vPlxuICAgICAgICAgICAgPGxhYmVsIGZvcj1cImVudHJ5VHlwZS0ke3RoaXMuaWR9XCI+JHt0aGlzLmxhYmVsfTwvbGFiZWw+XG4gICAgICAgIDwvZGl2PmA7XG4gICAgfVxufSIsImltcG9ydCBJRW50cnlUeXBlR3JvdXAgZnJvbSAnLi4vaW50ZXJmYWNlcy9JRW50cnlUeXBlR3JvdXAnO1xuaW1wb3J0IElFbnRyeVR5cGUgZnJvbSAnLi4vaW50ZXJmYWNlcy9JRW50cnlUeXBlJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRW50cnlUeXBlR3JvdXAgaW1wbGVtZW50cyBJRW50cnlUeXBlR3JvdXAge1xuICAgIHByaXZhdGUgZW50cnlUeXBlczogSUVudHJ5VHlwZVtdO1xuICAgIHByaXZhdGUgbm9kZTogSFRNTERpdkVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihlbnRyeVR5cGVzR3JvdXBDb250YWluZXI6IEhUTUxEaXZFbGVtZW50KSB7XG4gICAgICAgIHRoaXMubm9kZSA9IGVudHJ5VHlwZXNHcm91cENvbnRhaW5lcjtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVuZGVyKCk6IHZvaWQge1xuICAgICAgICBsZXQgZW50cnlUeXBlcyA9ICcnO1xuICAgICAgICBpZiAodGhpcy5lbnRyeVR5cGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgZW50cnlUeXBlcyA9IHRoaXMuZW50cnlUeXBlc1xuICAgICAgICAgICAgICAgIC5tYXAoKGVudHJ5VHlwZTogSUVudHJ5VHlwZSkgPT4gZW50cnlUeXBlLnRvSHRtbCgpKVxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHByZXY6IHN0cmluZywgY3VycmVudDogc3RyaW5nKSA9PiBwcmV2ICsgY3VycmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMubm9kZS5pbm5lckhUTUwgPSBgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJmaWVsZFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImhlYWRpbmdcIj5cbiAgICAgICAgICAgICAgICA8bGFiZWw+RW50cnlUeXBlczwvbGFiZWw+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpbnB1dCBsdHJcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2hlY2tib3gtc2VsZWN0XCI+XG4gICAgICAgICAgICAgICAgICAgICR7ZW50cnlUeXBlc31cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5gO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXRFbnRyeVR5cGVzKGVudHJ5VHlwZXM6IElFbnRyeVR5cGVbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLmVudHJ5VHlwZXMgPSBlbnRyeVR5cGVzO1xuICAgIH1cbn0iLCJpbXBvcnQgSVNlY3Rpb25NYXAgZnJvbSBcIi4uL2ludGVyZmFjZXMvSVNlY3Rpb25NYXBcIjtcbmltcG9ydCBJRW50cnlUeXBlIGZyb20gJy4uL2ludGVyZmFjZXMvSUVudHJ5VHlwZSc7XG5pbXBvcnQgSUNoYW5uZWwgZnJvbSAnLi4vaW50ZXJmYWNlcy9JQ2hhbm5lbCc7XG5pbXBvcnQgRW50cnlUeXBlIGZyb20gXCIuL0VudHJ5VHlwZVwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uTWFwIGltcGxlbWVudHMgSVNlY3Rpb25NYXAge1xuICAgIHB1YmxpYyBzZWN0aW9uczogSUNoYW5uZWxbXTtcbiAgICBwdWJsaWMgZW50cnlUeXBlczogSUVudHJ5VHlwZVtdO1xuXG4gICAgY29uc3RydWN0b3Ioc2VjdGlvbnM6IElDaGFubmVsW10sIGVudHJ5VHlwZXM6IElFbnRyeVR5cGVbXSkge1xuICAgICAgICB0aGlzLnNlY3Rpb25zID0gc2VjdGlvbnM7XG4gICAgICAgIHRoaXMuZW50cnlUeXBlcyA9IGVudHJ5VHlwZXMubWFwKChlbnRyeVR5cGVPYmplY3Q6IElFbnRyeVR5cGUpID0+IG5ldyBFbnRyeVR5cGUoZW50cnlUeXBlT2JqZWN0KSk7XG5cbiAgICAgICAgdGhpcy5nZXRFbnRyeVR5cGVzQnlTZWN0aW9uVWlkID0gdGhpcy5nZXRFbnRyeVR5cGVzQnlTZWN0aW9uVWlkLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuZ2V0RW50cnlUeXBlc0J5U2VjdGlvblVpZEFycmF5ID0gdGhpcy5nZXRFbnRyeVR5cGVzQnlTZWN0aW9uVWlkQXJyYXkuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5nZXRFbnRyeVR5cGVzQnlDaGFubmVsQXJyYXkgPSB0aGlzLmdldEVudHJ5VHlwZXNCeUNoYW5uZWxBcnJheS5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRFbnRyeVR5cGVzQnlTZWN0aW9uVWlkKHVpZDogc3RyaW5nKTogSUVudHJ5VHlwZVtdIHtcbiAgICAgICAgaWYgKCF1aWQgfHwgIXVpZC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtYXRjaGluZ1VpZDogSUVudHJ5VHlwZVtdID0gdGhpcy5lbnRyeVR5cGVzLmZpbHRlcigoZW50cnlUeXBlOiBJRW50cnlUeXBlKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZW50cnlUeXBlLnNlY3Rpb25VaWQgPT09IHVpZDtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChtYXRjaGluZ1VpZCAmJiBtYXRjaGluZ1VpZC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBtYXRjaGluZ1VpZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0RW50cnlUeXBlc0J5U2VjdGlvblVpZEFycmF5KHVpZHM6IHN0cmluZ1tdKTogSUVudHJ5VHlwZVtdIHtcbiAgICAgICAgY29uc3QgZW50cnlUeXBlczogSUVudHJ5VHlwZVtdID0gW107XG4gICAgICAgIHVpZHMuZm9yRWFjaCgodWlkOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZ2V0RW50cnlUeXBlc0J5U2VjdGlvblVpZCh1aWQpLmZvckVhY2goKGVudHJ5VHlwZTogSUVudHJ5VHlwZSkgPT4ge1xuICAgICAgICAgICAgICAgIGVudHJ5VHlwZXMucHVzaChlbnRyeVR5cGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBlbnRyeVR5cGVzO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRFbnRyeVR5cGVzQnlDaGFubmVsQXJyYXkoY2hhbm5lbHM6IElDaGFubmVsW10pOiBJRW50cnlUeXBlW10ge1xuICAgICAgICBjb25zdCB1aWRzOiBzdHJpbmdbXSA9IGNoYW5uZWxzLm1hcCgoY2hhbm5lbDogSUNoYW5uZWwpID0+IGNoYW5uZWwudWlkKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RW50cnlUeXBlc0J5U2VjdGlvblVpZEFycmF5KHVpZHMpO1xuICAgIH1cbn0iLCJcbnZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL21pbmktY3NzLWV4dHJhY3QtcGx1Z2luL2Rpc3QvbG9hZGVyLmpzIS4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4uLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/P2VtYmVkZGVkIS4uLy4uL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9saWIvbG9hZGVyLmpzIS4vZmllbGQuc2Nzc1wiKTtcblxuaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG5cbnZhciB0cmFuc2Zvcm07XG52YXIgaW5zZXJ0SW50bztcblxuXG5cbnZhciBvcHRpb25zID0ge1wiaG1yXCI6dHJ1ZX1cblxub3B0aW9ucy50cmFuc2Zvcm0gPSB0cmFuc2Zvcm1cbm9wdGlvbnMuaW5zZXJ0SW50byA9IHVuZGVmaW5lZDtcblxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9saWIvYWRkU3R5bGVzLmpzXCIpKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2FscztcblxuaWYobW9kdWxlLmhvdCkge1xuXHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL21pbmktY3NzLWV4dHJhY3QtcGx1Z2luL2Rpc3QvbG9hZGVyLmpzIS4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4uLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/P2VtYmVkZGVkIS4uLy4uL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9saWIvbG9hZGVyLmpzIS4vZmllbGQuc2Nzc1wiLCBmdW5jdGlvbigpIHtcblx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uL25vZGVfbW9kdWxlcy9taW5pLWNzcy1leHRyYWN0LXBsdWdpbi9kaXN0L2xvYWRlci5qcyEuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuLi8uLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjL2luZGV4LmpzPz9lbWJlZGRlZCEuLi8uLi9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvbGliL2xvYWRlci5qcyEuL2ZpZWxkLnNjc3NcIik7XG5cblx0XHRpZih0eXBlb2YgbmV3Q29udGVudCA9PT0gJ3N0cmluZycpIG5ld0NvbnRlbnQgPSBbW21vZHVsZS5pZCwgbmV3Q29udGVudCwgJyddXTtcblxuXHRcdHZhciBsb2NhbHMgPSAoZnVuY3Rpb24oYSwgYikge1xuXHRcdFx0dmFyIGtleSwgaWR4ID0gMDtcblxuXHRcdFx0Zm9yKGtleSBpbiBhKSB7XG5cdFx0XHRcdGlmKCFiIHx8IGFba2V5XSAhPT0gYltrZXldKSByZXR1cm4gZmFsc2U7XG5cdFx0XHRcdGlkeCsrO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3Ioa2V5IGluIGIpIGlkeC0tO1xuXG5cdFx0XHRyZXR1cm4gaWR4ID09PSAwO1xuXHRcdH0oY29udGVudC5sb2NhbHMsIG5ld0NvbnRlbnQubG9jYWxzKSk7XG5cblx0XHRpZighbG9jYWxzKSB0aHJvdyBuZXcgRXJyb3IoJ0Fib3J0aW5nIENTUyBITVIgZHVlIHRvIGNoYW5nZWQgY3NzLW1vZHVsZXMgbG9jYWxzLicpO1xuXG5cdFx0dXBkYXRlKG5ld0NvbnRlbnQpO1xuXHR9KTtcblxuXHRtb2R1bGUuaG90LmRpc3Bvc2UoZnVuY3Rpb24oKSB7IHVwZGF0ZSgpOyB9KTtcbn0iXSwic291cmNlUm9vdCI6IiJ9