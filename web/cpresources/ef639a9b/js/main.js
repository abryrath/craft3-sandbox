!function(e){function t(t){for(var s,o,c=t[0],a=t[1],u=t[2],h=0,d=[];h<c.length;h++)o=c[h],r[o]&&d.push(r[o][0]),r[o]=0;for(s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s]);for(l&&l(t);d.length;)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],s=!0,c=1;c<n.length;c++){var a=n[c];0!==r[a]&&(s=!1)}s&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var s={},r={main:0},i=[];function o(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=s,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(n,s,function(t){return e[t]}.bind(null,s));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var c=window.webpackJsonp=window.webpackJsonp||[],a=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=a;i.push([0,"vendor"]),n()}({"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/index.js!./node_modules/postcss-loader/src/index.js?!./node_modules/sass-loader/lib/loader.js!./resources/scss/field.scss":
/*!********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/postcss-loader/src??embedded!./node_modules/sass-loader/lib/loader.js!./resources/scss/field.scss ***!
  \********************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,n){},"./resources/js/RelatedEntryTypesField.ts":
/*!************************************************!*\
  !*** ./resources/js/RelatedEntryTypesField.ts ***!
  \************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=n(/*! ./components/ChannelGroup */"./resources/js/components/ChannelGroup.ts"),r=n(/*! ./components/SectionMap */"./resources/js/components/SectionMap.ts"),i=n(/*! ./components/EntryTypeGroup */"./resources/js/components/EntryTypeGroup.ts"),o=function(){function e(e){var t=this;this.namespacedId=e.namespace;var n=e.prefix;this.activeSections=[];var o=document.querySelector("#"+n+n+"channels");if(o){this.channelGroup=new s.default(o),this.activeSections=this.channelGroup.getActiveChannels();var c=JSON.parse(o.dataset.relatedEntryTypesChannels);this.sectionMap=new r.default(c.sections,c.entryTypes)}var a=document.querySelector("#"+n+n+"select");a&&(this.entryTypeGroup=new i.default(a),this.entryTypeGroup.setEntryTypes(this.sectionMap.getEntryTypesByChannelArray(this.activeSections)),this.entryTypeGroup.render()),this.updateActiveSections=this.updateActiveSections.bind(this),o.parentElement.addEventListener("channelChange",function(e){var n=e.detail,s=n.all,r=n.active;t.updateActiveSections(s,r)})}return e.prototype.updateActiveSections=function(e,t){this.activeSections=e?t?this.channelGroup.getChannels():[]:this.channelGroup.getActiveChannels();var n=this.sectionMap.getEntryTypesByChannelArray(this.activeSections);this.entryTypeGroup.setEntryTypes(n),this.entryTypeGroup.render()},e}();t.default=o,window.RelatedEntryTypesField=o},"./resources/js/components/AllChannel.ts":
/*!***********************************************!*\
  !*** ./resources/js/components/AllChannel.ts ***!
  \***********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s,r=n(/*! ./Channel */"./resources/js/components/Channel.ts"),i=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.checkboxChangeHandler=function(e){var t=e.target;this.active=t.checked;var n=new CustomEvent("channelChange",{detail:{sectionUid:this.uid,active:this.active,all:!0},bubbles:!0});return this.checkbox.dispatchEvent(n)},t}(r.default);t.default=o},"./resources/js/components/Channel.ts":
/*!********************************************!*\
  !*** ./resources/js/components/Channel.ts ***!
  \********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=function(){function e(e){this.checkbox=e,this.active=e.checked;var t=e.value.match(/section:(.*)/);t&&t.length&&(this.uid=t[1]),this.name=e.value;var n=document.querySelector('label[for="'+this.checkbox.id+'"]');n&&(this.label=n.innerText),this.checkboxChangeHandler=this.checkboxChangeHandler.bind(this),this.updateActiveStatus=this.updateActiveStatus.bind(this),this.checkbox.addEventListener("change",this.checkboxChangeHandler)}return e.prototype.updateActiveStatus=function(){this.active=this.checkbox.checked},e.prototype.checkboxChangeHandler=function(e){var t=e.target;this.active=t.checked;var n=new CustomEvent("channelChange",{detail:{sectionUid:this.uid,active:this.active,all:!1},bubbles:!0});return this.checkbox.dispatchEvent(n)},e}();t.default=s},"./resources/js/components/ChannelGroup.ts":
/*!*************************************************!*\
  !*** ./resources/js/components/ChannelGroup.ts ***!
  \*************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=n(/*! ./Channel */"./resources/js/components/Channel.ts"),r=n(/*! ./AllChannel */"./resources/js/components/AllChannel.ts"),i=function(){function e(e){this.node=e;var t=e.querySelectorAll('input[type="checkbox"]');this.channels=Array.from(t).map(function(e){return"*"===e.value?new r.default(e):new s.default(e)}),this.getActiveChannels=this.getActiveChannels.bind(this),this.getChannels=this.getChannels.bind(this)}return e.prototype.getChannels=function(){return this.channels},e.prototype.getActiveChannels=function(){return this.channels.filter(function(e){return e.updateActiveStatus(),e.active})},e}();t.default=i},"./resources/js/components/EntryType.ts":
/*!**********************************************!*\
  !*** ./resources/js/components/EntryType.ts ***!
  \**********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=function(){function e(e){this.id=e.id,this.label=e.label,this.sectionUid=e.sectionUid,this.active=e.active,this.toHtml=this.toHtml.bind(this)}return e.prototype.toHtml=function(){return'<div>\n            <input type="checkbox" name="types[unionco\\relatedentrytypes\\fields\\RelatedEntryTypesField][entryTypes][]" class="checkbox" value="'+this.id+'" id="entryType-'+this.id+'" '+(this.active?"checked":"")+'/>\n            <label for="entryType-'+this.id+'">'+this.label+"</label>\n        </div>"},e}();t.default=s},"./resources/js/components/EntryTypeGroup.ts":
/*!***************************************************!*\
  !*** ./resources/js/components/EntryTypeGroup.ts ***!
  \***************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=function(){function e(e){this.node=e}return e.prototype.render=function(){console.log(this.entryTypes);var e=this.node.querySelectorAll(".field.checkboxfield"),t=this.entryTypes.map(function(e){return e.id.toString()});e.forEach(function(e){var n=e.querySelector('input[type="checkbox"]').value;t.includes(n)?e.hidden=!1:e.hidden=!0})},e.prototype.setEntryTypes=function(e){this.entryTypes=e},e}();t.default=s},"./resources/js/components/SectionMap.ts":
/*!***********************************************!*\
  !*** ./resources/js/components/SectionMap.ts ***!
  \***********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=n(/*! ./EntryType */"./resources/js/components/EntryType.ts"),r=function(){function e(e,t){this.sections=e,this.entryTypes=t.map(function(e){return new s.default(e)}),this.getEntryTypesBySectionUid=this.getEntryTypesBySectionUid.bind(this),this.getEntryTypesBySectionUidArray=this.getEntryTypesBySectionUidArray.bind(this),this.getEntryTypesByChannelArray=this.getEntryTypesByChannelArray.bind(this)}return e.prototype.getEntryTypesBySectionUid=function(e){if(!e||!e.length)return[];var t=this.entryTypes.filter(function(t){return t.sectionUid===e});return t&&t.length?t:[]},e.prototype.getEntryTypesBySectionUidArray=function(e){var t=this,n=[];return e.forEach(function(e){t.getEntryTypesBySectionUid(e).forEach(function(e){n.push(e)})}),n},e.prototype.getEntryTypesByChannelArray=function(e){var t=e.map(function(e){return e.uid});return this.getEntryTypesBySectionUidArray(t)},e}();t.default=r},"./resources/scss/field.scss":
/*!***********************************!*\
  !*** ./resources/scss/field.scss ***!
  \***********************************/
/*! no static exports found */function(e,t,n){var s=n(/*! !../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader!../../node_modules/postcss-loader/src??embedded!../../node_modules/sass-loader/lib/loader.js!./field.scss */"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/index.js!./node_modules/postcss-loader/src/index.js?!./node_modules/sass-loader/lib/loader.js!./resources/scss/field.scss");"string"==typeof s&&(s=[[e.i,s,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(/*! ../../node_modules/style-loader/lib/addStyles.js */"./node_modules/style-loader/lib/addStyles.js")(s,r);s.locals&&(e.exports=s.locals)},0:
/*!**********************************************************************************!*\
  !*** multi ./resources/js/RelatedEntryTypesField.ts ./resources/scss/field.scss ***!
  \**********************************************************************************/
/*! no static exports found */function(e,t,n){n(/*! /Users/abryrath/Union/Library/relatedentrytypes/resources/js/RelatedEntryTypesField.ts */"./resources/js/RelatedEntryTypesField.ts"),e.exports=n(/*! /Users/abryrath/Union/Library/relatedentrytypes/resources/scss/field.scss */"./resources/scss/field.scss")}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vcmVzb3VyY2VzL2pzL1JlbGF0ZWRFbnRyeVR5cGVzRmllbGQudHMiLCJ3ZWJwYWNrOi8vLy4vcmVzb3VyY2VzL2pzL2NvbXBvbmVudHMvQWxsQ2hhbm5lbC50cyIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvY29tcG9uZW50cy9DaGFubmVsLnRzIiwid2VicGFjazovLy8uL3Jlc291cmNlcy9qcy9jb21wb25lbnRzL0NoYW5uZWxHcm91cC50cyIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvY29tcG9uZW50cy9FbnRyeVR5cGUudHMiLCJ3ZWJwYWNrOi8vLy4vcmVzb3VyY2VzL2pzL2NvbXBvbmVudHMvRW50cnlUeXBlR3JvdXAudHMiLCJ3ZWJwYWNrOi8vLy4vcmVzb3VyY2VzL2pzL2NvbXBvbmVudHMvU2VjdGlvbk1hcC50cyIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvc2Nzcy9maWVsZC5zY3NzIl0sIm5hbWVzIjpbIndlYnBhY2tKc29ucENhbGxiYWNrIiwiZGF0YSIsIm1vZHVsZUlkIiwiY2h1bmtJZCIsImNodW5rSWRzIiwibW9yZU1vZHVsZXMiLCJleGVjdXRlTW9kdWxlcyIsImkiLCJyZXNvbHZlcyIsImxlbmd0aCIsImluc3RhbGxlZENodW5rcyIsInB1c2giLCJPYmplY3QiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJtb2R1bGVzIiwicGFyZW50SnNvbnBGdW5jdGlvbiIsInNoaWZ0IiwiZGVmZXJyZWRNb2R1bGVzIiwiYXBwbHkiLCJjaGVja0RlZmVycmVkTW9kdWxlcyIsInJlc3VsdCIsImRlZmVycmVkTW9kdWxlIiwiZnVsZmlsbGVkIiwiaiIsImRlcElkIiwic3BsaWNlIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsInMiLCJpbnN0YWxsZWRNb2R1bGVzIiwibWFpbiIsImV4cG9ydHMiLCJtb2R1bGUiLCJsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInAiLCJqc29ucEFycmF5Iiwid2luZG93Iiwib2xkSnNvbnBGdW5jdGlvbiIsInNsaWNlIiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsIl9jb21wb25lbnRzX0NoYW5uZWxHcm91cF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fIiwiX2NvbXBvbmVudHNfU2VjdGlvbk1hcF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fIiwiX2NvbXBvbmVudHNfRW50cnlUeXBlR3JvdXBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfXyIsIlJlbGF0ZWRFbnRyeVR5cGVzRmllbGQiLCJqc29uVmFycyIsIl90aGlzIiwidGhpcyIsIm5hbWVzcGFjZWRJZCIsIm5hbWVzcGFjZSIsInByZWZpeCIsImFjdGl2ZVNlY3Rpb25zIiwiY2hhbm5lbEdyb3VwQ29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2hhbm5lbEdyb3VwIiwiZ2V0QWN0aXZlQ2hhbm5lbHMiLCJzZWN0aW9uTWFwRGF0YSIsIkpTT04iLCJwYXJzZSIsImRhdGFzZXQiLCJyZWxhdGVkRW50cnlUeXBlc0NoYW5uZWxzIiwic2VjdGlvbk1hcCIsInNlY3Rpb25zIiwiZW50cnlUeXBlcyIsImVudHJ5VHlwZXNHcm91cENvbnRhaW5lciIsImVudHJ5VHlwZUdyb3VwIiwic2V0RW50cnlUeXBlcyIsImdldEVudHJ5VHlwZXNCeUNoYW5uZWxBcnJheSIsInJlbmRlciIsInVwZGF0ZUFjdGl2ZVNlY3Rpb25zIiwicGFyZW50RWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiZXZlbnREZXRhaWwiLCJkZXRhaWwiLCJhbGwiLCJhY3RpdmUiLCJnZXRDaGFubmVscyIsIkFsbENoYW5uZWwiLCJfc3VwZXIiLCJub2RlIiwiX19leHRlbmRzIiwiY2hlY2tib3hDaGFuZ2VIYW5kbGVyIiwiY2hhbmdlRXZlbnQiLCJ0YXJnZXQiLCJjaGVja2VkIiwiZXZlbnQiLCJDdXN0b21FdmVudCIsInNlY3Rpb25VaWQiLCJ1aWQiLCJidWJibGVzIiwiY2hlY2tib3giLCJkaXNwYXRjaEV2ZW50IiwiX0NoYW5uZWxfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyIsIkNoYW5uZWwiLCJ1aWRNYXRjaCIsIm1hdGNoIiwibGFiZWwiLCJpZCIsImlubmVyVGV4dCIsInVwZGF0ZUFjdGl2ZVN0YXR1cyIsIl9BbGxDaGFubmVsX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX18iLCJDaGFubmVsR3JvdXAiLCJjaGVja2JveGVzIiwicXVlcnlTZWxlY3RvckFsbCIsImNoYW5uZWxzIiwiQXJyYXkiLCJmcm9tIiwibWFwIiwiZmlsdGVyIiwiY2hhbm5lbCIsIkVudHJ5VHlwZSIsImVudHJ5VHlwZSIsInRvSHRtbCIsIkVudHJ5VHlwZUdyb3VwIiwiY29uc29sZSIsImxvZyIsImZpZWxkcyIsImVudHJ5VHlwZUlkcyIsInRvU3RyaW5nIiwiZm9yRWFjaCIsImZpZWxkQ29udGFpbmVyIiwiaW5jbHVkZXMiLCJoaWRkZW4iLCJfRW50cnlUeXBlX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18iLCJTZWN0aW9uTWFwIiwiZW50cnlUeXBlT2JqZWN0IiwiZ2V0RW50cnlUeXBlc0J5U2VjdGlvblVpZCIsImdldEVudHJ5VHlwZXNCeVNlY3Rpb25VaWRBcnJheSIsIm1hdGNoaW5nVWlkIiwidWlkcyIsImNvbnRlbnQiLCJvcHRpb25zIiwiaG1yIiwidHJhbnNmb3JtIiwiaW5zZXJ0SW50byIsInVuZGVmaW5lZCIsImxvY2FscyJdLCJtYXBwaW5ncyI6ImFBQ0EsU0FBQUEsRUFBQUMsR0FRQSxJQVBBLElBTUFDLEVBQUFDLEVBTkFDLEVBQUFILEVBQUEsR0FD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QUFDLEVBQUEsQ0FBZUMsS0FBQSxFQUVmQyxlQVBBQSxFQVFBQyxnQkFBQUMsR0FFYXBJLHlEQUFRLCtDQUFSQSxDQUEyRCtILEVBQUFDLEdBRXhFRCxFQUFBTSxTQUFBaEksRUFBQUQsUUFBQTJILEVBQUFNIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBpbnN0YWxsIGEgSlNPTlAgY2FsbGJhY2sgZm9yIGNodW5rIGxvYWRpbmdcbiBcdGZ1bmN0aW9uIHdlYnBhY2tKc29ucENhbGxiYWNrKGRhdGEpIHtcbiBcdFx0dmFyIGNodW5rSWRzID0gZGF0YVswXTtcbiBcdFx0dmFyIG1vcmVNb2R1bGVzID0gZGF0YVsxXTtcbiBcdFx0dmFyIGV4ZWN1dGVNb2R1bGVzID0gZGF0YVsyXTtcblxuIFx0XHQvLyBhZGQgXCJtb3JlTW9kdWxlc1wiIHRvIHRoZSBtb2R1bGVzIG9iamVjdCxcbiBcdFx0Ly8gdGhlbiBmbGFnIGFsbCBcImNodW5rSWRzXCIgYXMgbG9hZGVkIGFuZCBmaXJlIGNhbGxiYWNrXG4gXHRcdHZhciBtb2R1bGVJZCwgY2h1bmtJZCwgaSA9IDAsIHJlc29sdmVzID0gW107XG4gXHRcdGZvcig7aSA8IGNodW5rSWRzLmxlbmd0aDsgaSsrKSB7XG4gXHRcdFx0Y2h1bmtJZCA9IGNodW5rSWRzW2ldO1xuIFx0XHRcdGlmKGluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuIFx0XHRcdFx0cmVzb2x2ZXMucHVzaChpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0pO1xuIFx0XHRcdH1cbiBcdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuIFx0XHR9XG4gXHRcdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuIFx0XHRcdGlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG4gXHRcdFx0XHRtb2R1bGVzW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcbiBcdFx0XHR9XG4gXHRcdH1cbiBcdFx0aWYocGFyZW50SnNvbnBGdW5jdGlvbikgcGFyZW50SnNvbnBGdW5jdGlvbihkYXRhKTtcblxuIFx0XHR3aGlsZShyZXNvbHZlcy5sZW5ndGgpIHtcbiBcdFx0XHRyZXNvbHZlcy5zaGlmdCgpKCk7XG4gXHRcdH1cblxuIFx0XHQvLyBhZGQgZW50cnkgbW9kdWxlcyBmcm9tIGxvYWRlZCBjaHVuayB0byBkZWZlcnJlZCBsaXN0XG4gXHRcdGRlZmVycmVkTW9kdWxlcy5wdXNoLmFwcGx5KGRlZmVycmVkTW9kdWxlcywgZXhlY3V0ZU1vZHVsZXMgfHwgW10pO1xuXG4gXHRcdC8vIHJ1biBkZWZlcnJlZCBtb2R1bGVzIHdoZW4gYWxsIGNodW5rcyByZWFkeVxuIFx0XHRyZXR1cm4gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKTtcbiBcdH07XG4gXHRmdW5jdGlvbiBjaGVja0RlZmVycmVkTW9kdWxlcygpIHtcbiBcdFx0dmFyIHJlc3VsdDtcbiBcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGRlZmVycmVkTW9kdWxlcy5sZW5ndGg7IGkrKykge1xuIFx0XHRcdHZhciBkZWZlcnJlZE1vZHVsZSA9IGRlZmVycmVkTW9kdWxlc1tpXTtcbiBcdFx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcbiBcdFx0XHRmb3IodmFyIGogPSAxOyBqIDwgZGVmZXJyZWRNb2R1bGUubGVuZ3RoOyBqKyspIHtcbiBcdFx0XHRcdHZhciBkZXBJZCA9IGRlZmVycmVkTW9kdWxlW2pdO1xuIFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtzW2RlcElkXSAhPT0gMCkgZnVsZmlsbGVkID0gZmFsc2U7XG4gXHRcdFx0fVxuIFx0XHRcdGlmKGZ1bGZpbGxlZCkge1xuIFx0XHRcdFx0ZGVmZXJyZWRNb2R1bGVzLnNwbGljZShpLS0sIDEpO1xuIFx0XHRcdFx0cmVzdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBkZWZlcnJlZE1vZHVsZVswXSk7XG4gXHRcdFx0fVxuIFx0XHR9XG4gXHRcdHJldHVybiByZXN1bHQ7XG4gXHR9XG5cbiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4gXHQvLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbiBcdC8vIFByb21pc2UgPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG4gXHR2YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuIFx0XHRcIm1haW5cIjogMFxuIFx0fTtcblxuIFx0dmFyIGRlZmVycmVkTW9kdWxlcyA9IFtdO1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHR2YXIganNvbnBBcnJheSA9IHdpbmRvd1tcIndlYnBhY2tKc29ucFwiXSA9IHdpbmRvd1tcIndlYnBhY2tKc29ucFwiXSB8fCBbXTtcbiBcdHZhciBvbGRKc29ucEZ1bmN0aW9uID0ganNvbnBBcnJheS5wdXNoLmJpbmQoanNvbnBBcnJheSk7XG4gXHRqc29ucEFycmF5LnB1c2ggPSB3ZWJwYWNrSnNvbnBDYWxsYmFjaztcbiBcdGpzb25wQXJyYXkgPSBqc29ucEFycmF5LnNsaWNlKCk7XG4gXHRmb3IodmFyIGkgPSAwOyBpIDwganNvbnBBcnJheS5sZW5ndGg7IGkrKykgd2VicGFja0pzb25wQ2FsbGJhY2soanNvbnBBcnJheVtpXSk7XG4gXHR2YXIgcGFyZW50SnNvbnBGdW5jdGlvbiA9IG9sZEpzb25wRnVuY3Rpb247XG5cblxuIFx0Ly8gYWRkIGVudHJ5IG1vZHVsZSB0byBkZWZlcnJlZCBsaXN0XG4gXHRkZWZlcnJlZE1vZHVsZXMucHVzaChbMCxcInZlbmRvclwiXSk7XG4gXHQvLyBydW4gZGVmZXJyZWQgbW9kdWxlcyB3aGVuIHJlYWR5XG4gXHRyZXR1cm4gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKTtcbiIsImltcG9ydCBJQ2hhbm5lbEdyb3VwIGZyb20gJy4vaW50ZXJmYWNlcy9JQ2hhbm5lbEdyb3VwJztcbmltcG9ydCBDaGFubmVsR3JvdXAgZnJvbSAnLi9jb21wb25lbnRzL0NoYW5uZWxHcm91cCc7XG5pbXBvcnQgSVNlY3Rpb25NYXAgZnJvbSAnLi9pbnRlcmZhY2VzL0lTZWN0aW9uTWFwJztcbmltcG9ydCBJQ2hhbm5lbCBmcm9tICcuL2ludGVyZmFjZXMvSUNoYW5uZWwnO1xuaW1wb3J0IFNlY3Rpb25NYXAgZnJvbSAnLi9jb21wb25lbnRzL1NlY3Rpb25NYXAnO1xuaW1wb3J0IEVudHJ5VHlwZUdyb3VwIGZyb20gJy4vY29tcG9uZW50cy9FbnRyeVR5cGVHcm91cCc7XG5pbXBvcnQgSUVudHJ5VHlwZUdyb3VwIGZyb20gJy4vaW50ZXJmYWNlcy9JRW50cnlUeXBlR3JvdXAnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZWxhdGVkRW50cnlUeXBlc0ZpZWxkIHtcbiAgICBwdWJsaWMgY2hhbm5lbEdyb3VwOiBJQ2hhbm5lbEdyb3VwO1xuICAgIHB1YmxpYyBmaWVsZENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHVibGljIGVudHJ5VHlwZUdyb3VwOiBJRW50cnlUeXBlR3JvdXA7XG4gICAgcHJpdmF0ZSBzZWN0aW9uTWFwOiBJU2VjdGlvbk1hcDtcbiAgICBwdWJsaWMgYWN0aXZlU2VjdGlvbnM6IElDaGFubmVsW107XG4gICAgcHVibGljIG5hbWVzcGFjZWRJZDogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IoanNvblZhcnM6IGFueSkge1xuICAgICAgICB0aGlzLm5hbWVzcGFjZWRJZCA9IGpzb25WYXJzLm5hbWVzcGFjZTtcbiAgICAgICAgY29uc3QgeyBwcmVmaXggfSA9IGpzb25WYXJzO1xuICAgICAgICB0aGlzLmFjdGl2ZVNlY3Rpb25zID0gW107XG4gICAgICAgIC8vIHRoaXMuZmllbGRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtqc29uVmFycy5pZH1gKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5maWVsZENvbnRhaW5lcik7XG4gICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGNoYW5uZWxzIHNlbGVjdCBhcmVhXG4gICAgICAgIGNvbnN0IGNoYW5uZWxHcm91cENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtwcmVmaXh9JHtwcmVmaXh9Y2hhbm5lbHNgKTtcblxuICAgICAgICBpZiAoY2hhbm5lbEdyb3VwQ29udGFpbmVyKSB7XG4gICAgICAgICAgICB0aGlzLmNoYW5uZWxHcm91cCA9IG5ldyBDaGFubmVsR3JvdXAoY2hhbm5lbEdyb3VwQ29udGFpbmVyKTtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlU2VjdGlvbnMgPSB0aGlzLmNoYW5uZWxHcm91cC5nZXRBY3RpdmVDaGFubmVscygpO1xuICAgICAgICAgICAgY29uc3Qgc2VjdGlvbk1hcERhdGE6IElTZWN0aW9uTWFwID0gSlNPTi5wYXJzZShjaGFubmVsR3JvdXBDb250YWluZXIuZGF0YXNldC5yZWxhdGVkRW50cnlUeXBlc0NoYW5uZWxzKTtcbiAgICAgICAgICAgIHRoaXMuc2VjdGlvbk1hcCA9IG5ldyBTZWN0aW9uTWFwKHNlY3Rpb25NYXBEYXRhLnNlY3Rpb25zLCBzZWN0aW9uTWFwRGF0YS5lbnRyeVR5cGVzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGVudHJ5VHlwZXNHcm91cENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtwcmVmaXh9JHtwcmVmaXh9c2VsZWN0YCk7XG5cbiAgICAgICAgaWYgKGVudHJ5VHlwZXNHcm91cENvbnRhaW5lcikge1xuICAgICAgICAgICAgdGhpcy5lbnRyeVR5cGVHcm91cCA9IG5ldyBFbnRyeVR5cGVHcm91cChlbnRyeVR5cGVzR3JvdXBDb250YWluZXIpO1xuXG4gICAgICAgICAgICB0aGlzLmVudHJ5VHlwZUdyb3VwLnNldEVudHJ5VHlwZXModGhpcy5zZWN0aW9uTWFwLmdldEVudHJ5VHlwZXNCeUNoYW5uZWxBcnJheSh0aGlzLmFjdGl2ZVNlY3Rpb25zKSk7XG4gICAgICAgICAgICB0aGlzLmVudHJ5VHlwZUdyb3VwLnJlbmRlcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWV0aG9kIGJpbmRpbmdcbiAgICAgICAgdGhpcy51cGRhdGVBY3RpdmVTZWN0aW9ucyA9IHRoaXMudXBkYXRlQWN0aXZlU2VjdGlvbnMuYmluZCh0aGlzKTtcblxuICAgICAgICAvLyBFdmVudCBMaXN0ZW5lcnNcbiAgICAgICAgY2hhbm5lbEdyb3VwQ29udGFpbmVyLnBhcmVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbm5lbENoYW5nZScsIChlOiBDdXN0b21FdmVudCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZXZlbnREZXRhaWwgPSBlLmRldGFpbDtcbiAgICAgICAgICAgIGNvbnN0IHsgYWxsLCBhY3RpdmUgfSA9IGV2ZW50RGV0YWlsO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVBY3RpdmVTZWN0aW9ucyhhbGwsIGFjdGl2ZSk7IC8vIHNlY3Rpb25VaWQsIGFjdGl2ZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyB1cGRhdGVBY3RpdmVTZWN0aW9ucyhhbGw6IGJvb2xlYW4sIGFjdGl2ZTogYm9vbGVhbikge1xuICAgICAgICBpZiAoYWxsKSB7XG4gICAgICAgICAgICBpZiAoYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVTZWN0aW9ucyA9IHRoaXMuY2hhbm5lbEdyb3VwLmdldENoYW5uZWxzKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlU2VjdGlvbnMgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlU2VjdGlvbnMgPSB0aGlzLmNoYW5uZWxHcm91cC5nZXRBY3RpdmVDaGFubmVscygpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGVudHJ5VHlwZXMgPSB0aGlzLnNlY3Rpb25NYXAuZ2V0RW50cnlUeXBlc0J5Q2hhbm5lbEFycmF5KHRoaXMuYWN0aXZlU2VjdGlvbnMpO1xuXG4gICAgICAgIHRoaXMuZW50cnlUeXBlR3JvdXAuc2V0RW50cnlUeXBlcyhlbnRyeVR5cGVzKTtcbiAgICAgICAgdGhpcy5lbnRyeVR5cGVHcm91cC5yZW5kZXIoKTtcbiAgICB9XG59XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgICBpbnRlcmZhY2UgV2luZG93IHtcbiAgICAgICAgUmVsYXRlZEVudHJ5VHlwZXNGaWVsZDogYW55O1xuICAgIH1cbn1cblxud2luZG93LlJlbGF0ZWRFbnRyeVR5cGVzRmllbGQgPSBSZWxhdGVkRW50cnlUeXBlc0ZpZWxkOyIsImltcG9ydCBJQ2hhbm5lbCBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JQ2hhbm5lbFwiO1xuaW1wb3J0IENoYW5uZWwgZnJvbSAnLi9DaGFubmVsJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQWxsQ2hhbm5lbCBleHRlbmRzIENoYW5uZWwgaW1wbGVtZW50cyBJQ2hhbm5lbCB7XG4gICAgY29uc3RydWN0b3Iobm9kZTogSFRNTElucHV0RWxlbWVudCkge1xuICAgICAgICBzdXBlcihub2RlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY2hlY2tib3hDaGFuZ2VIYW5kbGVyKGNoYW5nZUV2ZW50OiBFdmVudCk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCB0YXJnZXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSBjaGFuZ2VFdmVudC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSB0YXJnZXQuY2hlY2tlZDtcblxuICAgICAgICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudCgnY2hhbm5lbENoYW5nZScsIHtcbiAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICAgIHNlY3Rpb25VaWQ6IHRoaXMudWlkLFxuICAgICAgICAgICAgICAgIGFjdGl2ZTogdGhpcy5hY3RpdmUsXG4gICAgICAgICAgICAgICAgYWxsOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYnViYmxlczogdHJ1ZVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gdGhpcy5jaGVja2JveC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICB9XG59IiwiaW1wb3J0IElDaGFubmVsIGZyb20gXCIuLi9pbnRlcmZhY2VzL0lDaGFubmVsXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENoYW5uZWwgaW1wbGVtZW50cyBJQ2hhbm5lbCB7XG4gICAgcHJvdGVjdGVkIGNoZWNrYm94OiBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHB1YmxpYyBuYW1lOiBzdHJpbmc7XG4gICAgcHVibGljIGxhYmVsOiBzdHJpbmc7XG4gICAgcHVibGljIHVpZDogc3RyaW5nO1xuICAgIHB1YmxpYyBhY3RpdmU6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3Rvcihub2RlOiBIVE1MSW5wdXRFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuY2hlY2tib3ggPSBub2RlO1xuICAgICAgICB0aGlzLmFjdGl2ZSA9IG5vZGUuY2hlY2tlZDtcblxuICAgICAgICBjb25zdCB1aWRNYXRjaCA9IG5vZGUudmFsdWUubWF0Y2goL3NlY3Rpb246KC4qKS8pO1xuICAgICAgICBcbiAgICAgICAgaWYgKHVpZE1hdGNoICYmIHVpZE1hdGNoLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy51aWQgPSB1aWRNYXRjaFsxXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubmFtZSA9IG5vZGUudmFsdWU7XG4gICAgICAgIGNvbnN0IGxhYmVsOiBIVE1MTGFiZWxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgbGFiZWxbZm9yPVwiJHt0aGlzLmNoZWNrYm94LmlkfVwiXWApO1xuICAgICAgICBcbiAgICAgICAgaWYgKGxhYmVsKSB7XG4gICAgICAgICAgICB0aGlzLmxhYmVsID0gbGFiZWwuaW5uZXJUZXh0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWV0aG9kIGJpbmRpbmdcbiAgICAgICAgdGhpcy5jaGVja2JveENoYW5nZUhhbmRsZXIgPSB0aGlzLmNoZWNrYm94Q2hhbmdlSGFuZGxlci5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnVwZGF0ZUFjdGl2ZVN0YXR1cyA9IHRoaXMudXBkYXRlQWN0aXZlU3RhdHVzLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5jaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLmNoZWNrYm94Q2hhbmdlSGFuZGxlcik7XG4gICAgfVxuXG4gICAgcHVibGljIHVwZGF0ZUFjdGl2ZVN0YXR1cygpIHtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSB0aGlzLmNoZWNrYm94LmNoZWNrZWQ7XG4gICAgfVxuXG4gICAgcHVibGljIGNoZWNrYm94Q2hhbmdlSGFuZGxlcihjaGFuZ2VFdmVudDogRXZlbnQpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0OiBIVE1MSW5wdXRFbGVtZW50ID0gY2hhbmdlRXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIHRoaXMuYWN0aXZlID0gdGFyZ2V0LmNoZWNrZWQ7XG5cbiAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2NoYW5uZWxDaGFuZ2UnLCB7XG4gICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgICBzZWN0aW9uVWlkOiB0aGlzLnVpZCxcbiAgICAgICAgICAgICAgICBhY3RpdmU6IHRoaXMuYWN0aXZlLFxuICAgICAgICAgICAgICAgIGFsbDogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBidWJibGVzOiB0cnVlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrYm94LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgIH1cbn0iLCJpbXBvcnQgSUNoYW5uZWxHcm91cCBmcm9tICcuLi9pbnRlcmZhY2VzL0lDaGFubmVsR3JvdXAnO1xuaW1wb3J0IElDaGFubmVsIGZyb20gJy4uL2ludGVyZmFjZXMvSUNoYW5uZWwnO1xuaW1wb3J0IENoYW5uZWwgZnJvbSAnLi9DaGFubmVsJztcbmltcG9ydCBBbGxDaGFubmVsIGZyb20gJy4vQWxsQ2hhbm5lbCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENoYW5uZWxHcm91cCBpbXBsZW1lbnRzIElDaGFubmVsR3JvdXAge1xuICAgIHByaXZhdGUgY2hhbm5lbHM6IElDaGFubmVsW107XG4gICAgcHJpdmF0ZSBub2RlOiBIVE1MRGl2RWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKG5vZGU6IEhUTUxEaXZFbGVtZW50KSB7XG4gICAgICAgIHRoaXMubm9kZSA9IG5vZGU7XG4gICAgICAgIGNvbnN0IGNoZWNrYm94ZXM6IE5vZGVMaXN0T2Y8SFRNTElucHV0RWxlbWVudD4gPSBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXScpO1xuICAgICAgICB0aGlzLmNoYW5uZWxzID0gQXJyYXkuZnJvbShjaGVja2JveGVzKVxuICAgICAgICAgICAgLm1hcCgoY2hlY2tib3g6IEhUTUxJbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoY2hlY2tib3gudmFsdWUgPT09ICcqJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsbENoYW5uZWwoY2hlY2tib3gpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2hhbm5lbChjaGVja2JveCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vIE1ldGhvZCBiaW5kaW5nXG4gICAgICAgIHRoaXMuZ2V0QWN0aXZlQ2hhbm5lbHMgPSB0aGlzLmdldEFjdGl2ZUNoYW5uZWxzLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuZ2V0Q2hhbm5lbHMgPSB0aGlzLmdldENoYW5uZWxzLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldENoYW5uZWxzKCk6IElDaGFubmVsW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGFubmVscztcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0QWN0aXZlQ2hhbm5lbHMoKTogSUNoYW5uZWxbXSB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZUNoYW5uZWxzID0gdGhpcy5jaGFubmVscy5maWx0ZXIoKGNoYW5uZWw6IElDaGFubmVsKSA9PiB7XG4gICAgICAgICAgICBjaGFubmVsLnVwZGF0ZUFjdGl2ZVN0YXR1cygpO1xuICAgICAgICAgICAgcmV0dXJuIGNoYW5uZWwuYWN0aXZlO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gYWN0aXZlQ2hhbm5lbHM7XG4gICAgfVxufSIsImltcG9ydCBJRW50cnlUeXBlIGZyb20gJy4uL2ludGVyZmFjZXMvSUVudHJ5VHlwZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVudHJ5VHlwZSBpbXBsZW1lbnRzIElFbnRyeVR5cGUge1xuICAgIHB1YmxpYyBpZDogbnVtYmVyO1xuICAgIHB1YmxpYyBsYWJlbDogc3RyaW5nO1xuICAgIHB1YmxpYyBzZWN0aW9uVWlkOiBzdHJpbmc7XG4gICAgcHVibGljIGFjdGl2ZTogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKGVudHJ5VHlwZTogSUVudHJ5VHlwZSkge1xuICAgICAgICB0aGlzLmlkID0gZW50cnlUeXBlLmlkO1xuICAgICAgICB0aGlzLmxhYmVsID0gZW50cnlUeXBlLmxhYmVsO1xuICAgICAgICB0aGlzLnNlY3Rpb25VaWQgPSBlbnRyeVR5cGUuc2VjdGlvblVpZDtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSBlbnRyeVR5cGUuYWN0aXZlO1xuXG4gICAgICAgIHRoaXMudG9IdG1sID0gdGhpcy50b0h0bWwuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdG9IdG1sKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgPGRpdj5cbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuYW1lPVwidHlwZXNbdW5pb25jb1xcXFxyZWxhdGVkZW50cnl0eXBlc1xcXFxmaWVsZHNcXFxcUmVsYXRlZEVudHJ5VHlwZXNGaWVsZF1bZW50cnlUeXBlc11bXVwiIGNsYXNzPVwiY2hlY2tib3hcIiB2YWx1ZT1cIiR7dGhpcy5pZH1cIiBpZD1cImVudHJ5VHlwZS0ke3RoaXMuaWR9XCIgJHt0aGlzLmFjdGl2ZSA/ICdjaGVja2VkJyA6ICcnIH0vPlxuICAgICAgICAgICAgPGxhYmVsIGZvcj1cImVudHJ5VHlwZS0ke3RoaXMuaWR9XCI+JHt0aGlzLmxhYmVsfTwvbGFiZWw+XG4gICAgICAgIDwvZGl2PmA7XG4gICAgfVxufSIsImltcG9ydCBJRW50cnlUeXBlR3JvdXAgZnJvbSAnLi4vaW50ZXJmYWNlcy9JRW50cnlUeXBlR3JvdXAnO1xuaW1wb3J0IElFbnRyeVR5cGUgZnJvbSAnLi4vaW50ZXJmYWNlcy9JRW50cnlUeXBlJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRW50cnlUeXBlR3JvdXAgaW1wbGVtZW50cyBJRW50cnlUeXBlR3JvdXAge1xuICAgIHByaXZhdGUgZW50cnlUeXBlczogSUVudHJ5VHlwZVtdO1xuICAgIHByaXZhdGUgbm9kZTogSFRNTERpdkVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihlbnRyeVR5cGVzR3JvdXBDb250YWluZXI6IEhUTUxEaXZFbGVtZW50KSB7XG4gICAgICAgIHRoaXMubm9kZSA9IGVudHJ5VHlwZXNHcm91cENvbnRhaW5lcjtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVuZGVyKCk6IHZvaWQge1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmVudHJ5VHlwZXMpO1xuICAgICAgICBjb25zdCBmaWVsZHMgPSB0aGlzLm5vZGUucXVlcnlTZWxlY3RvckFsbCgnLmZpZWxkLmNoZWNrYm94ZmllbGQnKTtcbiAgICAgICAgY29uc3QgZW50cnlUeXBlSWRzOiBzdHJpbmdbXSA9IHRoaXMuZW50cnlUeXBlcy5tYXAoKGVudHJ5VHlwZTogSUVudHJ5VHlwZSkgPT4gZW50cnlUeXBlLmlkLnRvU3RyaW5nKCkpO1xuXG4gICAgICAgIGZpZWxkcy5mb3JFYWNoKChmaWVsZENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgY2hlY2tib3g6IEhUTUxJbnB1dEVsZW1lbnQgPSBmaWVsZENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKTtcbiAgICAgICAgICAgIGNvbnN0IGlkOiBzdHJpbmcgPSBjaGVja2JveC52YWx1ZTtcblxuICAgICAgICAgICAgaWYgKGVudHJ5VHlwZUlkcy5pbmNsdWRlcyhpZCkpIHtcbiAgICAgICAgICAgICAgICAvLyBzaG93XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuaGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmhpZGRlbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBsZXQgZW50cnlUeXBlcyA9ICcnO1xuICAgICAgICAvLyBpZiAodGhpcy5lbnRyeVR5cGVzLmxlbmd0aCkge1xuICAgICAgICAvLyAgICAgZW50cnlUeXBlcyA9IHRoaXMuZW50cnlUeXBlc1xuICAgICAgICAvLyAgICAgICAgIC5tYXAoKGVudHJ5VHlwZTogSUVudHJ5VHlwZSkgPT4gZW50cnlUeXBlLnRvSHRtbCgpKVxuICAgICAgICAvLyAgICAgICAgIC5yZWR1Y2UoKHByZXY6IHN0cmluZywgY3VycmVudDogc3RyaW5nKSA9PiBwcmV2ICsgY3VycmVudCk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgXG4gICAgICAgIC8vIHRoaXMubm9kZS5pbm5lckhUTUwgPSBgXG4gICAgICAgIC8vIDxkaXYgY2xhc3M9XCJmaWVsZFwiPlxuICAgICAgICAvLyAgICAgPGRpdiBjbGFzcz1cImhlYWRpbmdcIj5cbiAgICAgICAgLy8gICAgICAgICA8bGFiZWw+RW50cnlUeXBlczwvbGFiZWw+XG4gICAgICAgIC8vICAgICA8L2Rpdj5cbiAgICAgICAgLy8gICAgIDxkaXYgY2xhc3M9XCJpbnB1dCBsdHJcIj5cbiAgICAgICAgLy8gICAgICAgICA8ZGl2IGNsYXNzPVwiY2hlY2tib3gtc2VsZWN0XCI+XG4gICAgICAgIC8vICAgICAgICAgICAgICR7ZW50cnlUeXBlc31cbiAgICAgICAgLy8gICAgICAgICA8L2Rpdj5cbiAgICAgICAgLy8gICAgIDwvZGl2PlxuICAgICAgICAvLyA8L2Rpdj5gO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXRFbnRyeVR5cGVzKGVudHJ5VHlwZXM6IElFbnRyeVR5cGVbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLmVudHJ5VHlwZXMgPSBlbnRyeVR5cGVzO1xuICAgIH1cbn0iLCJpbXBvcnQgSVNlY3Rpb25NYXAgZnJvbSBcIi4uL2ludGVyZmFjZXMvSVNlY3Rpb25NYXBcIjtcbmltcG9ydCBJRW50cnlUeXBlIGZyb20gJy4uL2ludGVyZmFjZXMvSUVudHJ5VHlwZSc7XG5pbXBvcnQgSUNoYW5uZWwgZnJvbSAnLi4vaW50ZXJmYWNlcy9JQ2hhbm5lbCc7XG5pbXBvcnQgRW50cnlUeXBlIGZyb20gXCIuL0VudHJ5VHlwZVwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uTWFwIGltcGxlbWVudHMgSVNlY3Rpb25NYXAge1xuICAgIHB1YmxpYyBzZWN0aW9uczogSUNoYW5uZWxbXTtcbiAgICBwdWJsaWMgZW50cnlUeXBlczogSUVudHJ5VHlwZVtdO1xuXG4gICAgY29uc3RydWN0b3Ioc2VjdGlvbnM6IElDaGFubmVsW10sIGVudHJ5VHlwZXM6IElFbnRyeVR5cGVbXSkge1xuICAgICAgICB0aGlzLnNlY3Rpb25zID0gc2VjdGlvbnM7XG4gICAgICAgIHRoaXMuZW50cnlUeXBlcyA9IGVudHJ5VHlwZXMubWFwKChlbnRyeVR5cGVPYmplY3Q6IElFbnRyeVR5cGUpID0+IG5ldyBFbnRyeVR5cGUoZW50cnlUeXBlT2JqZWN0KSk7XG5cbiAgICAgICAgdGhpcy5nZXRFbnRyeVR5cGVzQnlTZWN0aW9uVWlkID0gdGhpcy5nZXRFbnRyeVR5cGVzQnlTZWN0aW9uVWlkLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuZ2V0RW50cnlUeXBlc0J5U2VjdGlvblVpZEFycmF5ID0gdGhpcy5nZXRFbnRyeVR5cGVzQnlTZWN0aW9uVWlkQXJyYXkuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5nZXRFbnRyeVR5cGVzQnlDaGFubmVsQXJyYXkgPSB0aGlzLmdldEVudHJ5VHlwZXNCeUNoYW5uZWxBcnJheS5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRFbnRyeVR5cGVzQnlTZWN0aW9uVWlkKHVpZDogc3RyaW5nKTogSUVudHJ5VHlwZVtdIHtcbiAgICAgICAgaWYgKCF1aWQgfHwgIXVpZC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtYXRjaGluZ1VpZDogSUVudHJ5VHlwZVtdID0gdGhpcy5lbnRyeVR5cGVzLmZpbHRlcigoZW50cnlUeXBlOiBJRW50cnlUeXBlKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZW50cnlUeXBlLnNlY3Rpb25VaWQgPT09IHVpZDtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChtYXRjaGluZ1VpZCAmJiBtYXRjaGluZ1VpZC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBtYXRjaGluZ1VpZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0RW50cnlUeXBlc0J5U2VjdGlvblVpZEFycmF5KHVpZHM6IHN0cmluZ1tdKTogSUVudHJ5VHlwZVtdIHtcbiAgICAgICAgY29uc3QgZW50cnlUeXBlczogSUVudHJ5VHlwZVtdID0gW107XG4gICAgICAgIHVpZHMuZm9yRWFjaCgodWlkOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZ2V0RW50cnlUeXBlc0J5U2VjdGlvblVpZCh1aWQpLmZvckVhY2goKGVudHJ5VHlwZTogSUVudHJ5VHlwZSkgPT4ge1xuICAgICAgICAgICAgICAgIGVudHJ5VHlwZXMucHVzaChlbnRyeVR5cGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBlbnRyeVR5cGVzO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRFbnRyeVR5cGVzQnlDaGFubmVsQXJyYXkoY2hhbm5lbHM6IElDaGFubmVsW10pOiBJRW50cnlUeXBlW10ge1xuICAgICAgICBjb25zdCB1aWRzOiBzdHJpbmdbXSA9IGNoYW5uZWxzLm1hcCgoY2hhbm5lbDogSUNoYW5uZWwpID0+IGNoYW5uZWwudWlkKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RW50cnlUeXBlc0J5U2VjdGlvblVpZEFycmF5KHVpZHMpO1xuICAgIH1cbn0iLCJcbnZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL21pbmktY3NzLWV4dHJhY3QtcGx1Z2luL2Rpc3QvbG9hZGVyLmpzIS4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4uLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/P2VtYmVkZGVkIS4uLy4uL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9saWIvbG9hZGVyLmpzIS4vZmllbGQuc2Nzc1wiKTtcblxuaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG5cbnZhciB0cmFuc2Zvcm07XG52YXIgaW5zZXJ0SW50bztcblxuXG5cbnZhciBvcHRpb25zID0ge1wiaG1yXCI6dHJ1ZX1cblxub3B0aW9ucy50cmFuc2Zvcm0gPSB0cmFuc2Zvcm1cbm9wdGlvbnMuaW5zZXJ0SW50byA9IHVuZGVmaW5lZDtcblxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9saWIvYWRkU3R5bGVzLmpzXCIpKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2FscztcblxuaWYobW9kdWxlLmhvdCkge1xuXHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL21pbmktY3NzLWV4dHJhY3QtcGx1Z2luL2Rpc3QvbG9hZGVyLmpzIS4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4uLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9zcmMvaW5kZXguanM/P2VtYmVkZGVkIS4uLy4uL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9saWIvbG9hZGVyLmpzIS4vZmllbGQuc2Nzc1wiLCBmdW5jdGlvbigpIHtcblx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uL25vZGVfbW9kdWxlcy9taW5pLWNzcy1leHRyYWN0LXBsdWdpbi9kaXN0L2xvYWRlci5qcyEuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuLi8uLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjL2luZGV4LmpzPz9lbWJlZGRlZCEuLi8uLi9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvbGliL2xvYWRlci5qcyEuL2ZpZWxkLnNjc3NcIik7XG5cblx0XHRpZih0eXBlb2YgbmV3Q29udGVudCA9PT0gJ3N0cmluZycpIG5ld0NvbnRlbnQgPSBbW21vZHVsZS5pZCwgbmV3Q29udGVudCwgJyddXTtcblxuXHRcdHZhciBsb2NhbHMgPSAoZnVuY3Rpb24oYSwgYikge1xuXHRcdFx0dmFyIGtleSwgaWR4ID0gMDtcblxuXHRcdFx0Zm9yKGtleSBpbiBhKSB7XG5cdFx0XHRcdGlmKCFiIHx8IGFba2V5XSAhPT0gYltrZXldKSByZXR1cm4gZmFsc2U7XG5cdFx0XHRcdGlkeCsrO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3Ioa2V5IGluIGIpIGlkeC0tO1xuXG5cdFx0XHRyZXR1cm4gaWR4ID09PSAwO1xuXHRcdH0oY29udGVudC5sb2NhbHMsIG5ld0NvbnRlbnQubG9jYWxzKSk7XG5cblx0XHRpZighbG9jYWxzKSB0aHJvdyBuZXcgRXJyb3IoJ0Fib3J0aW5nIENTUyBITVIgZHVlIHRvIGNoYW5nZWQgY3NzLW1vZHVsZXMgbG9jYWxzLicpO1xuXG5cdFx0dXBkYXRlKG5ld0NvbnRlbnQpO1xuXHR9KTtcblxuXHRtb2R1bGUuaG90LmRpc3Bvc2UoZnVuY3Rpb24oKSB7IHVwZGF0ZSgpOyB9KTtcbn0iXSwic291cmNlUm9vdCI6IiJ9